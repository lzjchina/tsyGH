(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-3397070d"],{"14c3":function(t,e,n){var i=n("c6b6"),s=n("9263");t.exports=function(t,e){var n=t.exec;if("function"===typeof n){var o=n.call(t,e);if("object"!==typeof o)throw TypeError("RegExp exec method returned something other than an Object or null");return o}if("RegExp"!==i(t))throw TypeError("RegExp#exec called on incompatible receiver");return s.call(t,e)}},"29b2":function(t,e,n){"use strict";var i=n("4360"),s={$ws:null,lockReturn:!1,timeout:3e5,timeoutObj:null,timeoutNum:null,serverTimeoutObj:null,initWebSocket:function(t){this.$ws=new WebSocket(t),this.$ws.onopen=this.wsOpen,this.$ws.onclose=this.wsClose,this.$ws.onmessage=this.wsMsg,this.$ws.onerror=this.wsError},wsOpen:function(t){s.startWsHeartbeat(),console.log("ws success")},wsClose:function(t){console.log(t,"ws close")},closeLink:function(){this.$ws.close(),i["a"].dispatch("web_socket_clearmsg")},wsSend:function(t){this.$ws.send(JSON.stringify(t)),i["a"].dispatch("web_socket_sendmsg",t)},wsMsg:function(t){s.resetHeartbeat(),i["a"].dispatch("web_socket_getmsg",t)},wsError:function(t){console.log(t,"ws error"),s.reconnect()},reconnect:function(){var t=this;t.lockReturn||(t.lockReturn=!0,t.timeoutNum&&clearTimeout(t.timeoutNum),t.timeoutNum=setTimeout((function(){t.initWebSocket(),t.lockReturn=!1}),3e3))},startWsHeartbeat:function(){var t=this;t.timeoutObj&&clearTimeout(t.timeoutObj),t.serverTimeoutObj&&clearTimeout(t.serverTimeoutObj),t.timeoutObj=setInterval((function(){1!=t.$ws.readyState&&t.reconnect()}),t.timeout)},resetHeartbeat:function(){var t=this;clearTimeout(t.timeoutObj),clearTimeout(t.serverTimeoutObj),t.startWsHeartbeat()}};e["a"]=s},"466d":function(t,e,n){"use strict";var i=n("d784"),s=n("825a"),o=n("50c4"),r=n("1d80"),a=n("8aa5"),c=n("14c3");i("match",1,(function(t,e,n){return[function(e){var n=r(this),i=void 0==e?void 0:e[t];return void 0!==i?i.call(e,n):new RegExp(e)[t](String(n))},function(t){var i=n(e,t,this);if(i.done)return i.value;var r=s(t),u=String(this);if(!r.global)return c(r,u);var l=r.unicode;r.lastIndex=0;var d,p=[],f=0;while(null!==(d=c(r,u))){var m=String(d[0]);p[f]=m,""===m&&(r.lastIndex=a(u,o(r.lastIndex),l)),f++}return 0===f?null:p}]}))},"568b":function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var i="wss://172.16.8.18:40506"},5899:function(t,e){t.exports="\t\n\v\f\r                　\u2028\u2029\ufeff"},"58a8":function(t,e,n){var i=n("1d80"),s=n("5899"),o="["+s+"]",r=RegExp("^"+o+o+"*"),a=RegExp(o+o+"*$"),c=function(t){return function(e){var n=String(i(e));return 1&t&&(n=n.replace(r,"")),2&t&&(n=n.replace(a,"")),n}};t.exports={start:c(1),end:c(2),trim:c(3)}},"5f6b":function(t,e,n){t.exports=n.p+"assets/img/noStart.62e70f03.png"},6547:function(t,e,n){var i=n("a691"),s=n("1d80"),o=function(t){return function(e,n){var o,r,a=String(s(e)),c=i(n),u=a.length;return c<0||c>=u?t?"":void 0:(o=a.charCodeAt(c),o<55296||o>56319||c+1===u||(r=a.charCodeAt(c+1))<56320||r>57343?t?a.charAt(c):o:t?a.slice(c,c+2):r-56320+(o-55296<<10)+65536)}};t.exports={codeAt:o(!1),charAt:o(!0)}},"8aa5":function(t,e,n){"use strict";var i=n("6547").charAt;t.exports=function(t,e,n){return e+(n?i(t,e).length:1)}},9263:function(t,e,n){"use strict";var i=n("ad6d"),s=n("9f7f"),o=RegExp.prototype.exec,r=String.prototype.replace,a=o,c=function(){var t=/a/,e=/b*/g;return o.call(t,"a"),o.call(e,"a"),0!==t.lastIndex||0!==e.lastIndex}(),u=s.UNSUPPORTED_Y||s.BROKEN_CARET,l=void 0!==/()??/.exec("")[1],d=c||l||u;d&&(a=function(t){var e,n,s,a,d=this,p=u&&d.sticky,f=i.call(d),m=d.source,v=0,h=t;return p&&(f=f.replace("y",""),-1===f.indexOf("g")&&(f+="g"),h=String(t).slice(d.lastIndex),d.lastIndex>0&&(!d.multiline||d.multiline&&"\n"!==t[d.lastIndex-1])&&(m="(?: "+m+")",h=" "+h,v++),n=new RegExp("^(?:"+m+")",f)),l&&(n=new RegExp("^"+m+"$(?!\\s)",f)),c&&(e=d.lastIndex),s=o.call(p?n:d,h),p?s?(s.input=s.input.slice(v),s[0]=s[0].slice(v),s.index=d.lastIndex,d.lastIndex+=s[0].length):d.lastIndex=0:c&&s&&(d.lastIndex=d.global?s.index+s[0].length:e),l&&s&&s.length>1&&r.call(s[0],n,(function(){for(a=1;a<arguments.length-2;a++)void 0===arguments[a]&&(s[a]=void 0)})),s}),t.exports=a},"9f7f":function(t,e,n){"use strict";var i=n("d039");function s(t,e){return RegExp(t,e)}e.UNSUPPORTED_Y=i((function(){var t=s("a","y");return t.lastIndex=2,null!=t.exec("abcd")})),e.BROKEN_CARET=i((function(){var t=s("^r","gy");return t.lastIndex=2,null!=t.exec("str")}))},ac1f:function(t,e,n){"use strict";var i=n("23e7"),s=n("9263");i({target:"RegExp",proto:!0,forced:/./.exec!==s},{exec:s})},ad6d:function(t,e,n){"use strict";var i=n("825a");t.exports=function(){var t=i(this),e="";return t.global&&(e+="g"),t.ignoreCase&&(e+="i"),t.multiline&&(e+="m"),t.dotAll&&(e+="s"),t.unicode&&(e+="u"),t.sticky&&(e+="y"),e}},b709:function(t,e,n){"use strict";var i=n("f6a8"),s=n.n(i);s.a},c3e5:function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAASCAYAAABB7B6eAAACfklEQVQ4T5WUPYgTQRTH/282WxiiqHiiHoincqKFYqWdRosjuzOeKMZG5FBsbOz0Cu88PQuxsbIInIogFgEJm50NOUE5rLQ4xc5Cw9mIiJUfOTDuPplgINnbJJfp5n393pv33hBix/f9NICrRHQOwA4AS8z8BMBdpVQ9bt/vTu0GJjgRvQRwKMHxDTMfGxTSAdBa3wIw1SOrWSnldL+s2/UdgCAIPjLzrh4BalLKpr5QKNjDw8OTRHSBmbcAeM/M00qp510BWus/AOwegFBKmTJ63/cfE9H5mG1IRCdd19UtebwHNSIa6QFYklKO+L5/gIjeAejwN37M/EEptTcREATBLDNf7wZg5ttKqSmt9UUAc93sbNvOjI2N/Tb6FVME4AURHY47M/NrAMfNFGmtTwF4lgRg5uVMJrMum83+XQEwgmKxuCadTk8CMHuw3ewBgKf1ev1OPp9fNjae5621LOsTgKGEROaUUpcSn2iQ8fN9/ygRmSo2tvm9CsNQjo+P/+wLqFQqQ2EY7mfm3UKITQBMyV+FECXHcX6YAFrrDVEUnRZCbCait47jzBMR99qD0SiKJojoBIB9bT2KADwiolnXdT8PUmmzydVqdWuj0bhHRGcAiFiAX5Zlnc3lcpWW3PO8g0YGIAtgFID5v74w8yIzayIqtr4U8jxvj2VZCwDMNsaPydyRUs7/b+62VCpVYGbZp4rvAK5JKR9SEAQLzHyki0NVSpkzulKptN627UUAO1f7RFEUXSGttWme1WWmm4tldOVy+bIQ4v5qgxs7Zv5mAB1d75gAohnXdW8aWRAEN5h5ZhBAc9G01mZhEsumNkC5XJ4QQjxIGIJezNo/9fb4rZPsrCIAAAAASUVORK5CYII="},d784:function(t,e,n){"use strict";var i=n("6eeb"),s=n("d039"),o=n("b622"),r=n("9263"),a=n("9112"),c=o("species"),u=!s((function(){var t=/./;return t.exec=function(){var t=[];return t.groups={a:"7"},t},"7"!=="".replace(t,"$<a>")})),l=function(){return"$0"==="a".replace(/./,"$0")}(),d=!s((function(){var t=/(?:)/,e=t.exec;t.exec=function(){return e.apply(this,arguments)};var n="ab".split(t);return 2!==n.length||"a"!==n[0]||"b"!==n[1]}));t.exports=function(t,e,n,p){var f=o(t),m=!s((function(){var e={};return e[f]=function(){return 7},7!=""[t](e)})),v=m&&!s((function(){var e=!1,n=/a/;return"split"===t&&(n={},n.constructor={},n.constructor[c]=function(){return n},n.flags="",n[f]=/./[f]),n.exec=function(){return e=!0,null},n[f](""),!e}));if(!m||!v||"replace"===t&&(!u||!l)||"split"===t&&!d){var h=/./[f],g=n(f,""[t],(function(t,e,n,i,s){return e.exec===r?m&&!s?{done:!0,value:h.call(e,n,i)}:{done:!0,value:t.call(n,e,i)}:{done:!1}}),{REPLACE_KEEPS_$0:l}),b=g[0],w=g[1];i(String.prototype,t,b),i(RegExp.prototype,f,2==e?function(t,e){return w.call(t,this,e)}:function(t){return w.call(t,this)})}p&&a(RegExp.prototype[f],"sham",!0)}},e1ab:function(t,e,n){"use strict";n.r(e);var i=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"ModeLiveDetails"},[i("div",{staticClass:"ModeaVideoMain"},[i("div",{staticClass:"videoBg"},[i("div",{staticClass:"tsy_Breadcrumb_white"},[i("router-link",{attrs:{to:"/"}},[t._v("首页")]),i("i",[t._v(">")]),i("span",[t._v("直播")]),i("i",[t._v(">")]),i("span",[t._v(t._s(t.LiveDetailsData.liveTitle))])],1),i("el-row",{staticClass:"videoMain",attrs:{gutter:0}},[i("el-col",{attrs:{xs:24,sm:24,md:24,lg:19}},[i("div",{staticClass:"videoBox"},[t.isPlaying?t._e():i("div",{staticClass:"noStartBg",on:{click:t.play}},[i("h3",{directives:[{name:"show",rawName:"v-show",value:t.coumtDownTime>0,expression:"coumtDownTime > 0"}]},[t._v("距离直播开始还剩")]),i("div",{directives:[{name:"show",rawName:"v-show",value:t.coumtDownTime>0,expression:"coumtDownTime > 0"}],staticClass:"countBox"},[i("span",[t._v(t._s(this.countTime.d))]),i("i",[t._v("天")]),t._v(" "),i("span",[t._v(t._s(this.countTime.h))]),i("i",[t._v("时")]),t._v(" "),i("span",[t._v(t._s(this.countTime.m))]),i("i",[t._v("分")]),t._v(" "),i("span",[t._v(t._s(this.countTime.s))]),i("i",[t._v("秒")])]),i("img",{attrs:{src:n("5f6b"),alt:""}})]),i("div",{attrs:{id:"id_test_video"}})])]),i("el-col",{attrs:{xs:24,sm:24,md:24,lg:5}},[i("div",{staticClass:"videoList"},[i("h2",{staticClass:"title"},[t._v("聊天")]),i("ul",{ref:"textMsg",staticClass:"list",on:{scroll:t.scrollText}},t._l(t.msgData,(function(e,n){return i("li",{key:n,class:-1==e[0].indexOf("other")?"selfName":"otherName"},[i("dl",[i("dd",[t._v(t._s(e[1].sendUserName))]),i("dt",[t._v(" "+t._s(e[1].content)+" ")])])])})),0),i("div",{staticClass:"ModeinputArea"},[i("el-input",{attrs:{placeholder:"马上发表评论吧",size:"mini"},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.sendMsg(e)}},model:{value:t.input,callback:function(e){t.input=e},expression:"input"}}),i("el-button",{attrs:{size:"mini"},on:{click:t.sendMsg}},[t._v("发送")])],1)])])],1),i("div",{staticClass:"videoDes"},[i("div",{staticClass:"items"},[i("h1",{staticClass:"videoTitle"},[t._v(t._s(t.LiveDetailsData.liveTitle))]),i("div",{staticClass:"tips"},[i("img",{attrs:{src:n("c3e5"),alt:""}}),i("span",[t._v(t._s(t.roomNumber)+"人正在参与")])])])])],1)]),""!=t.LiveDetailsData.profile&&"<p><br></p>"!=t.LiveDetailsData.profile?i("div",{staticClass:"introduction"},[i("div",[t._m(0),i("div",{staticClass:"introductionMain wangEditStyle",domProps:{innerHTML:t._s(t.LiveDetailsData.profile)}})])]):t._e()])},s=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("h1",{staticClass:"introductionH"},[n("span",[t._v("课程介绍")])])}],o=(n("a4d3"),n("99af"),n("4de4"),n("e439"),n("dbb4"),n("b64b"),n("e25e"),n("ac1f"),n("466d"),n("159b"),n("ade3")),r=n("29b2"),a=n("2f62"),c=n("2319"),u=n("568b");function l(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function d(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?l(Object(n),!0).forEach((function(e){Object(o["a"])(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var p={name:"Video",data:function(){var t=this;return{input:"",message_array:[],LiveName:"PPS塑料快速验证、配色小批量试验...",videoId:"",visitNum:1,order:!0,ordered:!1,ws:null,LiveDetailsData:"",options:{rtmp:"",m3u8:"",flv:"",autoplay:!0,poster:"",width:"100%",height:"100%",pausePosterEnabled:!0,listener:function(e){"error"==e.type&&(t.isPlaying=!1)}},canScroll:!0,timer:null,scrollTop:"",roomNumber:1,roomNum:this.$route.query.room,TcpPlayer:"",isPlaying:!1,coumtDownTime:"",coumtDownTimeText:"",baseURL:u["a"],WS:null,countTime:{d:0,h:0,m:0,s:0}}},components:{},watch:{msgData:function(){var t=this;this.canScroll&&setTimeout((function(){t.toLast()}),100)},auth:function(t){if(void 0!=t&&"undefined"!=t){var e=this.$route.query.room;r["a"].closeLink(),r["a"].initWebSocket("".concat(this.baseURL,"/web/live/chat/").concat(e,"/").concat(this.auth.userId))}}},computed:d({},Object(a["b"])({msgData:function(t){var e=t.socket.wbMsg;return e},auth:function(t){return t.Login.auth}})),created:function(){this.getRoomNum()},mounted:function(){var t=this;this.goPAGE(),setInterval((function(){t.countDownTime(t.LiveDetailsData.liveStartDate)}),1e3),this.wsLink()},beforeDestroy:function(){r["a"].closeLink(),this.WS.close()},methods:{wsLink:function(){var t=this,e=this.$route.query.room;this.WS=new WebSocket("ws://".concat(this.baseURL,"/web/live/").concat(e,"/audience-count")),this.WS.onopen=function(){console.log("连接")},this.WS.onmessage=function(e){var n=JSON.parse(e.data);t.roomNumber=n.data},this.WS.onclose=function(){console.log("关闭")}},goPAGE:function(){navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i)&&this.$router.push({path:"/PhoneLive",query:{room:this.roomNum}})},countDownTime:function(t){var e=new Date,n=new Date(t),i=parseInt((n.getTime()-e.getTime())/1e3);this.coumtDownTime=i,this.countTime.d=parseInt(i/86400),this.countTime.h=parseInt(i/3600),this.countTime.m=parseInt(i/60%60),this.countTime.s=parseInt(i%60)},scrollText:function(){var t=this;this.$refs.textMsg.scrollTop<this.scrollTop&&(this.canScroll=!1,clearTimeout(this.timer),this.timer=setTimeout((function(){t.canScroll=!0}),5e3))},toLast:function(){this.$refs.textMsg.scrollTop=this.$refs.textMsg.scrollHeight,this.scrollTop=this.$refs.textMsg.scrollTop},judgeLogin:function(){var t=this.$store.state.Login.auth;return"undefined"!=t&&void 0!=t&&null!=t||(this.$message({type:"error",message:"请先登录"}),this.$store.dispatch("controlDia",!0),!1)},getRoomNum:function(){var t=this.$route.query.room;this.getLiveDetails(t),r["a"].initWebSocket("ws://".concat(this.baseURL,"/web/live/chat/").concat(t,"/").concat(this.auth.userId))},getLiveDetails:function(t){var e=this;Object(c["b"])(t).then((function(t){if(200==t.code){e.LiveDetailsData=t.data;var n=t.data.playList,i=n.filter((function(t){return 3==t.type})),s=n.filter((function(t){return 1==t.type})),o=n.filter((function(t){return 2==t.type}));e.options.m3u8=i[0].playUrl,e.options.flv=o[0].playUrl,e.options.rtmp=s[0].playUrl,e.loadScript((function(){return e.initVideo("id_test_video")}),{id:"tcPlayerScriptId",url:"//imgcache.qq.com/open/qcloud/video/vcplayer/TcPlayer-2.3.2.js"})}}))},sendMsg:function(){var t=this,e=this.judgeLogin();if(e){var n={content:this.input,sendUserName:this.auth.userName,type:0};""==this.input?this.$message({type:"error",message:"请输入你要发表的评论"}):(r["a"].wsSend(n),this.input="",setTimeout((function(){t.toLast()}),100))}},play:function(){this.coumtDownTime<=0?this.TcpPlayer.play():this.$message({type:"warning",message:"直播未开始,请耐心等待"})},getCurrentTime:function(){this.TcpPlayer.currentTime()},loadNewVideo:function(t){this.TcpPlayer.load(t)},loadScript:function(t,e){if(document.getElementById(e.id))t();else{var n=document.createElement("script");n.async=!0,n.src=e.url,n.id=e.id,n.onload=function(){t()},document.body.appendChild(n)}},initVideo:function(t){var e=this;try{this.TcpPlayer=new TcPlayer(t,this.options),setTimeout((function(){e.isPlaying=e.TcpPlayer.playing()}),3e3),this.isPlaying=this.TcpPlayer.playing()}catch(n){console.log(n)}}}},f=p,m=(n("b709"),n("2877")),v=Object(m["a"])(f,i,s,!1,null,null,null);e["default"]=v.exports},e25e:function(t,e,n){var i=n("23e7"),s=n("e583");i({global:!0,forced:parseInt!=s},{parseInt:s})},e583:function(t,e,n){var i=n("da84"),s=n("58a8").trim,o=n("5899"),r=i.parseInt,a=/^[+-]?0[Xx]/,c=8!==r(o+"08")||22!==r(o+"0x16");t.exports=c?function(t,e){var n=s(String(t));return r(n,e>>>0||(a.test(n)?16:10))}:r},f6a8:function(t,e,n){}}]);